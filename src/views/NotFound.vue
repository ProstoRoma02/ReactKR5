<template>
  <div class="not-found">
    <div class="error-container">
      <!-- –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è 404 -->
      <div class="error-number">
        <span class="digit" :class="{ animate: animate }">4</span>
        <span class="digit zero" :class="{ animate: animate }">0</span>
        <span class="digit" :class="{ animate: animate }">4</span>
      </div>
      
      <!-- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ -->
      <div class="error-message">
        <h1>–°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞</h1>
        <p>–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –±—ã–ª–∞ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∞.</p>
      </div>
      
      <!-- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç -->
      <div class="interactive-element">
        <div 
          class="lost-astronaut"
          :class="{ floating: isFloating }"
          @click="toggleFloat"
        >
          üöÄ
        </div>
        <p class="astronaut-text">–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ —Ä–∞–∫–µ—Ç—É!</p>
      </div>
      
      <!-- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è -->
      <div class="suggestions">
        <h3>–ß—Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ —Å–¥–µ–ª–∞—Ç—å:</h3>
        <div class="suggestion-list">
          <div class="suggestion-item">
            <span class="suggestion-icon">üè†</span>
            <div class="suggestion-content">
              <h4>–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é</h4>
              <p>–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</p>
            </div>
            <router-link to="/" class="btn">–ì–ª–∞–≤–Ω–∞—è</router-link>
          </div>
          
          <div class="suggestion-item">
            <span class="suggestion-icon">üéÆ</span>
            <div class="suggestion-content">
              <h4>–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–µ–º–æ</h4>
              <p>–ò–∑—É—á–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</p>
            </div>
            <router-link to="/demo" class="btn">–î–µ–º–æ</router-link>
          </div>
          
          <div class="suggestion-item">
            <span class="suggestion-icon">üë§</span>
            <div class="suggestion-content">
              <h4>–ü–µ—Ä–µ–π—Ç–∏ –≤ –ø—Ä–æ—Ñ–∏–ª—å</h4>
              <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∞—à–∏–º –ø—Ä–æ—Ñ–∏–ª–µ–º</p>
            </div>
            <router-link to="/profile" class="btn">–ü—Ä–æ—Ñ–∏–ª—å</router-link>
          </div>
          
          <div class="suggestion-item">
            <span class="suggestion-icon">‚öôÔ∏è</span>
            <div class="suggestion-content">
              <h4>–û—Ç–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h4>
              <p>–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥ —Å–µ–±—è</p>
            </div>
            <router-link to="/settings" class="btn">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</router-link>
          </div>
        </div>
      </div>
      
      <!-- –ü–æ–∏—Å–∫ -->
      <div class="search-section">
        <h3>–ò–ª–∏ –Ω–∞–π–¥–∏—Ç–µ —Ç–æ, —á—Ç–æ –∏—â–µ—Ç–µ:</h3>
        <div class="search-form">
          <input
            v-model="searchQuery"
            @keyup.enter="performSearch"
            type="text"
            placeholder="–ü–æ–∏—Å–∫ –ø–æ —Å–∞–π—Ç—É..."
            class="search-input"
          >
          <button @click="performSearch" class="search-btn">
            üîç –ù–∞–π—Ç–∏
          </button>
        </div>
        
        <div v-if="searchResults.length > 0" class="search-results">
          <h4>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞:</h4>
          <div class="results-list">
            <router-link
              v-for="result in searchResults"
              :key="result.path"
              :to="result.path"
              class="result-item"
            >
              <span class="result-icon">{{ result.icon }}</span>
              <div class="result-content">
                <div class="result-title">{{ result.title }}</div>
                <div class="result-description">{{ result.description }}</div>
              </div>
            </router-link>
          </div>
        </div>
        
        <div v-else-if="searchQuery && hasSearched" class="no-results">
          <p>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –ø–æ –∑–∞–ø—Ä–æ—Å—É "{{ searchQuery }}"</p>
          <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å</p>
        </div>
      </div>
      
      <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—à–∏–±–∫–µ -->
      <div class="error-details">
        <details>
          <summary>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</summary>
          <div class="tech-info">
            <p><strong>URL:</strong> {{ currentPath }}</p>
            <p><strong>–í—Ä–µ–º—è:</strong> {{ currentTime }}</p>
            <p><strong>User Agent:</strong> {{ userAgent }}</p>
            <p><strong>Referrer:</strong> {{ referrer || '–ü—Ä—è–º–æ–π –ø–µ—Ä–µ—Ö–æ–¥' }}</p>
          </div>
        </details>
      </div>
      
      <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
      <div class="navigation-buttons">
        <button @click="goBack" class="btn btn-secondary">
          ‚Üê –ù–∞–∑–∞–¥
        </button>
        <button @click="reload" class="btn btn-secondary">
          üîÑ –û–±–Ω–æ–≤–∏—Ç—å
        </button>
        <router-link to="/" class="btn">
          üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é
        </router-link>
      </div>
    </div>
    
    <!-- –§–æ–Ω–æ–≤–∞—è –∞–Ω–∏–º–∞—Ü–∏—è -->
    <div class="background-animation">
      <div 
        v-for="star in stars" 
        :key="star.id"
        class="star"
        :style="{
          left: star.x + '%',
          top: star.y + '%',
          animationDelay: star.delay + 's',
          animationDuration: star.duration + 's'
        }"
      ></div>
    </div>
  </div>
</template>

<script setup>
import { ref, computed, onMounted } from 'vue'
import { useRoute, useRouter } from 'vue-router'

const route = useRoute()
const router = useRouter()

// –†–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
const animate = ref(false)
const isFloating = ref(false)
const searchQuery = ref('')
const hasSearched = ref(false)
const searchResults = ref([])

// –ó–≤–µ–∑–¥—ã –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏
const stars = ref([])

// –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –ø–æ–∏—Å–∫–∞
const availablePages = [
  {
    path: '/',
    title: '–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞',
    description: '–û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è',
    icon: 'üè†',
    keywords: ['–≥–ª–∞–≤–Ω–∞—è', 'home', '–æ—Å–Ω–æ–≤–Ω–∞—è', '–Ω–∞—á–∞–ª–æ']
  },
  {
    path: '/demo',
    title: '–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è',
    description: '–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤',
    icon: 'üéÆ',
    keywords: ['–¥–µ–º–æ', 'demo', '–ø—Ä–∏–º–µ—Ä—ã', '–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã', '–ø–æ–∫–∞–∑–∞—Ç—å']
  },
  {
    path: '/profile',
    title: '–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è',
    description: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–º –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∞–∫–∫–∞—É–Ω—Ç–∞',
    icon: 'üë§',
    keywords: ['–ø—Ä–æ—Ñ–∏–ª—å', 'profile', '–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å', '–∞–∫–∫–∞—É–Ω—Ç', '–ª–∏—á–Ω—ã–π']
  },
  {
    path: '/settings',
    title: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏',
    description: '–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è',
    icon: '‚öôÔ∏è',
    keywords: ['–Ω–∞—Å—Ç—Ä–æ–π–∫–∏', 'settings', '–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è', '–ø–∞—Ä–∞–º–µ—Ç—Ä—ã']
  }
]

// –í—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞
const currentPath = computed(() => route.fullPath)
const currentTime = computed(() => new Date().toLocaleString('ru-RU'))
const userAgent = computed(() => navigator.userAgent)
const referrer = computed(() => document.referrer)

// –ú–µ—Ç–æ–¥—ã
const toggleFloat = () => {
  isFloating.value = !isFloating.value
}

const performSearch = () => {
  hasSearched.value = true
  
  if (!searchQuery.value.trim()) {
    searchResults.value = []
    return
  }
  
  const query = searchQuery.value.toLowerCase()
  
  searchResults.value = availablePages.filter(page => {
    return page.title.toLowerCase().includes(query) ||
           page.description.toLowerCase().includes(query) ||
           page.keywords.some(keyword => keyword.includes(query))
  })
}

const goBack = () => {
  if (window.history.length > 1) {
    router.go(-1)
  } else {
    router.push('/')
  }
}

const reload = () => {
  window.location.reload()
}

const generateStars = () => {
  stars.value = Array.from({ length: 50 }, (_, i) => ({
    id: i,
    x: Math.random() * 100,
    y: Math.random() * 100,
    delay: Math.random() * 3,
    duration: 2 + Math.random() * 3
  }))
}

// –•—É–∫–∏ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
onMounted(() => {
  // –ó–∞–ø—É—Å–∫ –∞–Ω–∏–º–∞—Ü–∏–∏ 404
  setTimeout(() => {
    animate.value = true
  }, 500)
  
  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–≤–µ–∑–¥
  generateStars()
  
  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫, –µ—Å–ª–∏ –≤ URL –µ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
  const urlParams = new URLSearchParams(window.location.search)
  const searchParam = urlParams.get('search')
  if (searchParam) {
    searchQuery.value = searchParam
    performSearch()
  }
})
</script>

<style scoped>
.not-found {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  overflow: hidden;
}

.error-container {
  max-width: 800px;
  width: 90%;
  text-align: center;
  z-index: 10;
  position: relative;
}

/* –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è 404 */
.error-number {
  display: flex;
  justify-content: center;
  gap: 1rem;
  margin-bottom: 2rem;
}

.digit {
  font-size: 8rem;
  font-weight: bold;
  text-shadow: 4px 4px 8px rgba(0,0,0,0.3);
  transform: translateY(100px);
  opacity: 0;
  transition: all 0.8s ease;
}

.digit.animate {
  transform: translateY(0);
  opacity: 1;
}

.digit.zero {
  color: #f093fb;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0%, 100% { transform: scale(1) translateY(0); }
  50% { transform: scale(1.1) translateY(-10px); }
}

/* –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ */
.error-message {
  margin-bottom: 3rem;
}

.error-message h1 {
  font-size: 2.5rem;
  margin-bottom: 1rem;
  text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
}

.error-message p {
  font-size: 1.2rem;
  opacity: 0.9;
  max-width: 600px;
  margin: 0 auto;
}

/* –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç */
.interactive-element {
  margin-bottom: 3rem;
}

.lost-astronaut {
  font-size: 4rem;
  cursor: pointer;
  display: inline-block;
  transition: all 0.3s ease;
  margin-bottom: 1rem;
}

.lost-astronaut:hover {
  transform: scale(1.1);
}

.lost-astronaut.floating {
  animation: float 3s ease-in-out infinite;
}

@keyframes float {
  0%, 100% { transform: translateY(0) rotate(0deg); }
  25% { transform: translateY(-20px) rotate(5deg); }
  50% { transform: translateY(-10px) rotate(-5deg); }
  75% { transform: translateY(-30px) rotate(3deg); }
}

.astronaut-text {
  font-size: 0.9rem;
  opacity: 0.8;
}

/* –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è */
.suggestions {
  background: rgba(255,255,255,0.1);
  backdrop-filter: blur(10px);
  border-radius: 20px;
  padding: 2rem;
  margin-bottom: 2rem;
}

.suggestions h3 {
  margin-bottom: 1.5rem;
  font-size: 1.5rem;
}

.suggestion-list {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 1rem;
}

.suggestion-item {
  display: flex;
  align-items: center;
  gap: 1rem;
  background: rgba(255,255,255,0.1);
  border-radius: 15px;
  padding: 1.5rem;
  transition: all 0.3s;
}

.suggestion-item:hover {
  background: rgba(255,255,255,0.2);
  transform: translateY(-2px);
}

.suggestion-icon {
  font-size: 2rem;
  flex-shrink: 0;
}

.suggestion-content {
  flex: 1;
  text-align: left;
}

.suggestion-content h4 {
  margin-bottom: 0.5rem;
  font-size: 1.1rem;
}

.suggestion-content p {
  font-size: 0.9rem;
  opacity: 0.8;
  margin: 0;
}

/* –ü–æ–∏—Å–∫ */
.search-section {
  background: rgba(255,255,255,0.1);
  backdrop-filter: blur(10px);
  border-radius: 20px;
  padding: 2rem;
  margin-bottom: 2rem;
}

.search-section h3 {
  margin-bottom: 1.5rem;
  font-size: 1.5rem;
}

.search-form {
  display: flex;
  gap: 1rem;
  margin-bottom: 1.5rem;
  max-width: 500px;
  margin-left: auto;
  margin-right: auto;
}

.search-input {
  flex: 1;
  padding: 0.75rem 1rem;
  border: none;
  border-radius: 25px;
  font-size: 1rem;
  background: rgba(255,255,255,0.9);
  color: #333;
}

.search-input::placeholder {
  color: #666;
}

.search-btn {
  padding: 0.75rem 1.5rem;
  background: rgba(255,255,255,0.2);
  border: 2px solid rgba(255,255,255,0.3);
  border-radius: 25px;
  color: white;
  cursor: pointer;
  transition: all 0.3s;
  white-space: nowrap;
}

.search-btn:hover {
  background: rgba(255,255,255,0.3);
}

/* –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ */
.search-results {
  text-align: left;
}

.search-results h4 {
  margin-bottom: 1rem;
  text-align: center;
}

.results-list {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.result-item {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  background: rgba(255,255,255,0.1);
  border-radius: 10px;
  color: white;
  text-decoration: none;
  transition: all 0.3s;
}

.result-item:hover {
  background: rgba(255,255,255,0.2);
  transform: translateX(10px);
}

.result-icon {
  font-size: 1.5rem;
}

.result-content {
  flex: 1;
}

.result-title {
  font-weight: bold;
  margin-bottom: 0.25rem;
}

.result-description {
  font-size: 0.9rem;
  opacity: 0.8;
}

.no-results {
  text-align: center;
  opacity: 0.8;
}

/* –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è */
.error-details {
  margin-bottom: 2rem;
}

.error-details details {
  background: rgba(255,255,255,0.1);
  border-radius: 10px;
  padding: 1rem;
}

.error-details summary {
  cursor: pointer;
  font-weight: bold;
  margin-bottom: 1rem;
}

.tech-info {
  text-align: left;
  font-family: monospace;
  font-size: 0.9rem;
  opacity: 0.8;
}

.tech-info p {
  margin-bottom: 0.5rem;
  word-break: break-all;
}

/* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
.navigation-buttons {
  display: flex;
  gap: 1rem;
  justify-content: center;
  flex-wrap: wrap;
}

.btn {
  padding: 0.75rem 1.5rem;
  background: rgba(255,255,255,0.2);
  border: 2px solid rgba(255,255,255,0.3);
  border-radius: 25px;
  color: white;
  text-decoration: none;
  cursor: pointer;
  transition: all 0.3s;
  display: inline-block;
}

.btn:hover {
  background: rgba(255,255,255,0.3);
  transform: translateY(-2px);
}

.btn-secondary {
  background: transparent;
}

/* –§–æ–Ω–æ–≤–∞—è –∞–Ω–∏–º–∞—Ü–∏—è */
.background-animation {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

.star {
  position: absolute;
  width: 2px;
  height: 2px;
  background: white;
  border-radius: 50%;
  animation: twinkle linear infinite;
}

@keyframes twinkle {
  0%, 100% { opacity: 0; transform: scale(0); }
  50% { opacity: 1; transform: scale(1); }
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
@media (max-width: 768px) {
  .digit {
    font-size: 4rem;
  }
  
  .error-message h1 {
    font-size: 2rem;
  }
  
  .error-message p {
    font-size: 1rem;
  }
  
  .suggestion-list {
    grid-template-columns: 1fr;
  }
  
  .suggestion-item {
    flex-direction: column;
    text-align: center;
  }
  
  .search-form {
    flex-direction: column;
  }
  
  .navigation-buttons {
    flex-direction: column;
    align-items: center;
  }
  
  .result-item {
    flex-direction: column;
    text-align: center;
  }
}
</style>